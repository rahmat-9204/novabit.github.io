<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>NovaBit Exchange</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { font-family: Arial; margin:0; padding:0; background:#111; color:#fff; }
    header { display:flex; justify-content:space-between; padding:10px 20px; background:#222; align-items:center; }
    header h1 { margin:0; color:#00ffa3; }
    .lang button { margin-right:5px; cursor:pointer; }
    .main { padding:20px; text-align:center; }
    .cards { display:flex; justify-content:center; gap:20px; margin:20px 0; }
    .card { background:#222; padding:20px; border-radius:10px; min-width:100px; font-size:20px; }
    table { width:80%; margin:20px auto; border-collapse:collapse; background:#222; color:#fff; }
    table th, table td { border:1px solid #00ffa3; padding:10px; }
    button { background:#00ffa3; color:#111; border:none; padding:5px 10px; cursor:pointer; border-radius:5px; }
    .chart-container { width: 90%; max-width: 700px; margin: auto; }
    footer { text-align:center; padding:10px; background:#222; margin-top:20px; color:#00ffa3; }
  </style>
</head>
<body>

<header>
  <h1 id="title">صرافی نوابیت</h1>
  <div class="lang">
    <button onclick="setLang('fa')">FA</button>
    <button onclick="setLang('en')">EN</button>
    <a href="login.html" style="color:#00ffa3;text-decoration:none; margin-left:10px;">
      ورود / ثبت‌نام
    </a>
  </div>
</header>

<div class="main">
  <h2 id="welcome">به صرافی ارز دیجیتال نوابیت خوش آمدید</h2>
  <p id="desc">خرید و فروش امن ارزهای دیجیتال با بهترین قیمت</p>

  <div class="cards">
    <div class="card">
      BTC<br>
      <span id="btc">Loading...</span>
    </div>
    <div class="card">
      ETH<br>
      <span id="eth">Loading...</span>
    </div>
    <div class="card">
      USDT<br>
      <span id="usdt">Loading...</span>
    </div>
  </div>

  <!-- جدول موجودی کیف پول -->
  <div class="wallet">
    <h3>موجودی کیف پول</h3>
    <table>
      <thead>
        <tr>
          <th>ارز</th>
          <th>مقدار</th>
          <th>اقدامات</th>
        </tr>
      </thead>
      <tbody id="wallet-table">
        <tr>
          <td>BTC</td>
          <td>0.5</td>
          <td><button>واریز</button> <button>برداشت</button></td>
        </tr>
        <tr>
          <td>ETH</td>
          <td>2</td>
          <td><button>واریز</button> <button>برداشت</button></td>
        </tr>
        <tr>
          <td>USDT</td>
          <td>1000</td>
          <td><button>واریز</button> <button>برداشت</button></td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- جدول معاملات کاربر -->
  <div class="trades">
    <h3>آخرین معاملات</h3>
    <table>
      <thead>
        <tr>
          <th>جفت ارز</th>
          <th>نوع</th>
          <th>مقدار</th>
          <th>قیمت</th>
        </tr>
      </thead>
      <tbody id="trades-table">
        <tr>
          <td>BTC/USDT</td>
          <td>خرید</td>
          <td>0.1</td>
          <td>$30,000</td>
        </tr>
        <tr>
          <td>ETH/USDT</td>
          <td>فروش</td>
          <td>1</td>
          <td>$2,000</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- نمودار قیمت -->
  <div class="chart-container">
    <h3>نمودار قیمت BTC/ETH/USDT</h3>
    <canvas id="cryptoChart"></canvas>
  </div>

</div>

<footer>
  © 2025 NovaBit Exchange
</footer>

<!-- کتابخانه Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  // ---------- تغییر زبان ----------
  function setLang(lang) {
    const titleEl = document.getElementById('title');
    const welcomeEl = document.getElementById('welcome');
    const descEl = document.getElementById('desc');

    if (lang === 'fa') {
      document.documentElement.lang = 'fa';
      document.body.style.direction = 'rtl';
      titleEl.innerText = 'صرافی نوابیت';
      welcomeEl.innerText = 'به صرافی ارز دیجیتال نوابیت خوش آمدید';
      descEl.innerText = 'خرید و فروش امن ارزهای دیجیتال با بهترین قیمت';
    } else {
      document.documentElement.lang = 'en';
      document.body.style.direction = 'ltr';
      titleEl.innerText = 'NovaBit Exchange';
      welcomeEl.innerText = 'Welcome to NovaBit Crypto Exchange';
      descEl.innerText = 'Secure trading of cryptocurrencies at the best prices';
    }
  }

  // ---------- دریافت قیمت ارز دیجیتال ----------
  async function loadPrices() {
    try {
      const res = await fetch(
        "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,tether&vs_currencies=usd"
      );
      const data = await res.json();

      document.getElementById("btc").innerText = "$" + data.bitcoin.usd;
      document.getElementById("eth").innerText = "$" + data.ethereum.usd;
      document.getElementById("usdt").innerText = "$" + data.tether.usd;
    } catch (err) {
      console.error("Error loading prices:", err);
      document.getElementById("btc").innerText = "Error";
      document.getElementById("eth").innerText = "Error";
      document.getElementById("usdt").innerText = "Error";
    }
  }

  loadPrices();
  setInterval(loadPrices, 30000); // هر ۳۰ ثانیه آپدیت

  // ---------- نمودار زنده ----------
  const ctx = document.getElementById('cryptoChart').getContext('2d');

  let cryptoChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: [],
      datasets: [
        { label: 'BTC', data: [], borderColor: 'orange', fill: false },
        { label: 'ETH', data: [], borderColor: 'blue', fill: false },
        { label: 'USDT', data: [], borderColor: 'green', fill: false }
      ]
    },
    options: {
      responsive: true,
      animation: false,
      scales: {
        x: { title: { display: true, text: 'زمان' } },
        y: { title: { display: true, text: 'قیمت (USD)' } }
      }
    }
  });

  async function updateChart() {
    try {
      const res = await fetch(
        "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,tether&vs_currencies=usd"
      );
      const data = await res.json();
      const time = new Date().toLocaleTimeString();

      cryptoChart.data.labels.push(time);
      cryptoChart.data.datasets[0].data.push(data.bitcoin.usd);
      cryptoChart.data.datasets[1].data.push(data.ethereum.usd);
      cryptoChart.data.datasets[2].data.push(data.tether.usd);

      if (cryptoChart.data.labels.length > 20) {
        cryptoChart.data.labels.shift();
        cryptoChart.data.datasets.forEach(ds => ds.data.shift());
      }

      cryptoChart.update();
    } catch (err) {
      console.error("Error updating chart:", err);
    }
  }

  setInterval(updateChart, 30000);
  updateChart();
</script>

</body>
</html>
